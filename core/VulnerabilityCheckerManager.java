package whoami.core;

import burp.api.montoya.http.message.HttpRequestResponse;
import whoami.checkers.SQLiChecker;

import java.util.ArrayList;
import java.util.List;
import java.util.Set;

public class VulnerabilityCheckerManager {
    private final List<Object> checkers = new ArrayList<>();
    
    public VulnerabilityCheckerManager(CoreModules core) {
        checkers.add(new SQLiChecker(core));
    }

    public List<Object> getCheckers() {
        return checkers;
    }

    public void runChecker(String checkerName, HttpRequestResponse requestResponse) {
        for (Object checker : checkers) {
            if (checker instanceof SQLiChecker && checkerName.equals("SQLi")) {
                ((SQLiChecker) checker).checkForSQLi(requestResponse.request(), Set.of());
            }
            // Add other checker types here as implemented
        }
    }
}
